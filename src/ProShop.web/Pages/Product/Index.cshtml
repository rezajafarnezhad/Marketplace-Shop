@page "/product/pc-{productCode}/{slug}"
@using ProShop.Common.Helpers;
@using Microsoft.EntityFrameworkCore.Infrastructure
@using ProShop.ViewModels.Product.ProductComments
@using Microsoft.AspNetCore.Mvc.TagHelpers
@model ProShop.web.Pages.Product.IndexModel
@{
    var firstImage = Model.ProductInfo.ProductMedia.First(c => !c.IsVideo).FileName;
    var showscore = Model.ProductInfo.Score > 0;
    var showcommentscount = Model.ProductInfo.productCommentsCount > 0;
    var showquestioncommentscount = false;
    var productFeatures = Model.ProductInfo.ProductFeatures.Where(c => c.FeatureShowNextToProduct).ToList();



    var productVariants = Model.ProductInfo.ProductVariants.OrderBy(c => c.FinalPrice).ToList();


    var firstProductVariant = productVariants.FirstOrDefault();

    //var isvariantColor = !string.IsNullOrWhiteSpace(firstProductVariant.VariantColorCode);
    var isvariantColor = !string.IsNullOrWhiteSpace(Model.ProductInfo.ProductVariants.First().VariantColorCode);


    var productTitle = Model.ProductInfo.PersianTitle;
    var productCategory = Model.ProductInfo.CategoryTitle;
    var productBrand = Model.ProductInfo.BrandTitleFa;

    var GroupVariants = productVariants.GroupBy(c => c.VariantValue);



    ViewData["Title"] = $"مشخصات قیمت و خرید {productTitle}";
    ViewData["HeaderDescription"] =
        $"خرید اینترنتی {productTitle} و قیمت انواع {productCategory} {productBrand} از فروشگاه آنلاین پروشاپ. جدیدترین مدل های {productCategory} {productBrand} با بهترین قیمت در پروشاپ";




}

<!-- Start breadcrumb -->

<div class="container-fluid mt-3 rem14px" product-id="@Model.ProductInfo.Id" comment-Pages-Count="@Model.ProductInfo.productCommentsCount">
    <nav>
        <ol class="breadcrumb">
            <li class="breadcrumb-item">
                <a class="active" href="/">فروشگاه پروشاپ</a>
            </li>
            @{
                var productCategoriesCount = Model.ProductInfo.productCategories.Count;
                var LastCategory = Model.ProductInfo.productCategories.Last();
            }
            @foreach (var category in Model.ProductInfo.productCategories.Take(productCategoriesCount - 1))
            {
                <li class="breadcrumb-item">
                    <a class="active" asp-page="@category.CategorySlug">@category.CategoryTitle</a>
                </li>
            }
            <li class="breadcrumb-item active">@LastCategory.CategoryTitle</li>
        </ol>
    </nav>
</div>

<!-- End breadcrumb -->
<!-- Start show product info -->

<div class="container-fluid bg-white pb-3" id="show-product-box">
    <div class="row mt-3">
        <div class="col-lg-5">
            <div class="row">
                <div class="col-2" id="buttons-next-to-gallery-box">
                    <ul class="list-inline">

                        <li>
                            @{
                                var IsFavorite = Model.ProductInfo.isFavorite;
                            }
                            <form id="add-product-to-favorite-form" asp-page-handler="AddOrRemoveFavorite" method="post" class="public-ajax-form" call-function-in-the-end="addFavoriteFunc">
                                <input type="hidden" name="Id" value="@Model.ProductInfo.Id" />
                                <input type="hidden" name="addFavorite" value="@(IsFavorite?"false":"true")" />
                                <button id="AddFavoritebtn" class="btn" data-bs-toggle="tooltip" data-bs-placement="left"
                                        title="افزودن به علاقه مندی ها">
                                    <i class="bi bi-heart @(IsFavorite?"d-none":"")"></i>
                                    <i class="bi bi-heart-fill text-danger @(IsFavorite?"":"d-none")"></i>
                                </button>
                            </form>

                        </li>
                        <li>
                            <button id="ShareProductBtn" type="button" class="btn" data-bs-toggle="tooltip" data-bs-placement="left"
                                    title="اشتراک گذاری">
                                <i class="bi bi-share-fill"></i>
                            </button>
                        </li>
                        <li>
                            <button type="button" class="btn" data-bs-toggle="tooltip" data-bs-placement="left"
                                    title="اطلاع رسانی شگفت انگیز">
                                <i class="bi bi-bell"></i>
                            </button>
                        </li>
                        <li>
                            <button type="button" class="btn" data-bs-toggle="tooltip" data-bs-placement="left" title="نمودار قیمت">
                                <i class="bi bi-graph-up"></i>
                            </button>
                        </li>
                        <li>
                            <a href="/Compare/pc-@Model.ProductInfo.ProductCode" class="btn" data-bs-toggle="tooltip" data-bs-placement="left" title="مقایسه">
                                <i class="bi bi-square-half"></i>
                            </a>
                        </li>
                        <li>
                            <button type="button" class="btn" data-bs-toggle="tooltip" data-bs-placement="left"
                                    title="اضافه به لیست">
                                <i class="bi bi-list-ul"></i>
                            </button>
                        </li>
                    </ul>
                </div>
                <div class="col-10">
                    <div class="border-bottom text-center" id="zoom-image-place">
                        <img src="~/images/Products/@firstImage" class="img-fluid pb-2 border-bottom" alt="@productTitle">
                    </div>
                </div>
                <div class="text-center mt-3" id="product-thumbnails-box">
                    <ul class="list-inline">

                        @foreach (var Image in Model.ProductInfo.ProductMedia.Where(c => !c.IsVideo))
                        {
                            <li class="list-inline-item rounded-3">
                                <button class="btn p-0 w-100 h-100">
                                    <img src="~/images/Products/@Image.FileName" class="w-100 h-100 p-1" alt="@productTitle">
                                </button>
                            </li>
                        }
                        @if (Model.ProductInfo.ProductMedia.Where(c => !c.IsVideo).Count() > 5 || Model.ProductInfo.ProductMedia.Count() > 0)
                        {
                            <li class="list-inline-item rounded-3">
                                <button class="btn p-0 w-100 h-100">
                                    <i class="bi bi-three-dots"></i>
                                </button>
                            </li>
                        }
                    </ul>

                </div>
            </div>
        </div>
        <div class="col-lg-7">
            <div class="row">
                <div class="d-flex">
                    @if (!string.IsNullOrWhiteSpace(Model.ProductInfo.BrandLogoPicture))
                    {
                        <div>
                            <img src="~/images/brands/@Model.ProductInfo.BrandLogoPicture" width="60" class="me-2" alt="@Model.ProductInfo.BrandTitleFa">
                        </div>
                    }
                    <div class="d-flex flex-column justify-content-between">
                        <div>
                            <a class="abrnad" href="#">@Model.ProductInfo.BrandTitleFa</a>

                            <a class="abrnad" href="#">
                                /
                                @Model.ProductInfo.CategoryTitle
                                @Model.ProductInfo.BrandTitleFa
                            </a>
                        </div>
                        <h5 id="product-fa-title-in-show-product-info">
                            @productTitle
                        </h5>
                    </div>
                </div>
            </div>
            <div class="row mt-2 mt-sm-3 mt-md-4">
                <div class="col-md-7">
                    <div class="d-flex align-items-center text-muted">

                        @if (!string.IsNullOrWhiteSpace(Model.ProductInfo.EnglishTitle))
                        {
                            <small class="me-2 text-custom-grey">
                                @Model.ProductInfo.EnglishTitle
                            </small>
                        }

                        <div id="product-en-title-line" class="flex-grow-1 bg-custom-grey"></div>
                    </div>
                    <div class="mt-2 d-flex @(!showscore && !showcommentscount && !showquestioncommentscount ? "d-none":string.Empty)">

                        @if (showscore)
                        {
                            <!-- Stars -->

                            <div class="d-flex align-items-center me-2">
                                <span>
                                    <i class="bi bi-star-fill text-warning"></i>
                                    <span class="rem13px persian-numbers">
                                        @Model.ProductInfo.Score.ToString("0.#")
                                    </span>
                                    <span class="text-custom-grey rem12px">
                                        (
                                        @Model.ProductInfo.productCommentsLongCount
                                        نفر
                                        )
                                    </span>
                                </span>
                                <div class="bg-custom-grey mx-2 rounded-circle product-info-dots"></div>
                            </div>

                            <!-- End stars -->
                        }

                        @if (showcommentscount)
                        {
                            <!-- Comments -->

                            <div class="d-flex align-items-center me-2">
                                <span class="rem13px text-info persian-numbers">
                                    @Model.ProductInfo.productCommentsCount
                                    دیدگاه
                                </span>
                                <div class="bg-custom-grey mx-2 rounded-circle product-info-dots"></div>
                            </div>

                            <!-- End comments -->
                        }

                        <!-- Questions -->
                        @if (showquestioncommentscount)
                        {
                            <div class="d-flex align-items-center">
                                <span class="rem13px text-info persian-numbers">
                                    ۴۶۷۶
                                    پرسش
                                </span>
                            </div>
                        }


                        <!-- End questions -->
                    </div>
                    @if (showscore && Model.ProductInfo.SuggestPercentage > 70@*&& Model.ProductInfo.SuggestCount>2*@)
{
<div class="row mt-2 mt-md-3">
    <span class="d-flex align-items-center">
        <i class="bi bi-hand-thumbs-up text-success me-1 rem16px"></i>
        <span class="rem13px persian-numbers">
            @Model.ProductInfo.SuggestPercentage.ToString("0.#")%
            (
            @Model.ProductInfo.SuggestCount
            ) نفر از خریداران، این کالا را پیشنهاد کرده اند
        </span>
        <i class="bi bi-info-circle ms-2" data-bs-toggle="tooltip" data-bs-placement="bottom"
           title="خریداران کالا با انتخاب یکی از گزینه های پیشنهاد یا عدم پیشنهاد، تجربه خرید خود را با کاربران به اشتراک می گذارند."></i>
    </span>
</div>
}


                    @if (!Model.ProductInfo.IsVariantTypeNull)
                    {
                        <div class="mt-4">
                            <div class="fw-bold rem17px">
                                @if (isvariantColor)
                                {
                                    <text> رنگ:</text>
                                }
                                else
                                {
                                    <text> اندازه:</text>
                                }
                                <span id="Product-variant-Value" class="persian-numbers">
                                    @firstProductVariant.VariantValue
                                </span>
                            </div>

                            <div class="d-flex mt-3" id="product-variants-box-in-show-product-info">
                                @if (isvariantColor)
                                {
                                    @foreach (var variant in GroupVariants)
                                    {
                                        var currentVariant = variant.First();
                                        <div data-bs-toggle="tooltip" data-bs-placement="bottom" product-variant-id="@currentVariant.Id" title="@currentVariant.VariantValue"
                                             class="pointer-cursor rounded-circle d-flex justify-content-center align-items-center">
                                            <span class="rounded-circle d-flex justify-content-center align-items-center" style="background-color:@currentVariant.VariantColorCode">
                                                <i class="bi bi-check2 rem21px fw-bold d-none"></i>
                                            </span>
                                        </div>
                                    }

                                }
                                else
                                {
                                    <select class="form-select w-auto">
                                        @foreach (var variant in GroupVariants)
                                        {
                                            var currentVariant = variant.First();
                                            <option product-variant-id="@currentVariant.Id" value="@currentVariant.VariantValue">
                                                @currentVariant.VariantValue
                                            </option>
                                        }
                                    </select>
                                }

                            </div>
                        </div>
                    }


                    @if (productFeatures.Count > 0)
                    {
                        <div class="mt-4" id="ProductFeaturesBox">
                            <div class="fw-bold rem17px">
                                ویژگی ها
                            </div>
                            <ul class="mt-3 p-0 rem13px">

                                @{
                                    var counter = 0;
                                }
                                @foreach (var feature in productFeatures)
                                {
                                    <li class="d-flex align-items-center my-2 @(counter > 1 ?"d-none" : "")">
                                        <div class="bg-custom-grey mx-2 rounded-circle product-info-dots">
                                        </div>
                                        <div class="text-secondary">
                                            @feature.FeatureTitle :
                                            &nbsp;
                                        </div>
                                        <div class="fw-bold rem14px">
                                            @{
                                                var value = feature.Value.Split("|||");

                                            }
                                            @string.Join(" , ", value)
                                        </div>
                                    </li>
                                    counter++;
                                }

                            </ul>
                            @if (productFeatures.Count() > 2)
                            {
                                <div class="text-info rem13px pointer-cursor" id="ShowAllProductFeatures">
                                    مشاهده بیشتر
                                    <i class="bi bi-chevron-left"></i>
                                </div>
                            }

                        </div>

                    }
                    @if (!string.IsNullOrWhiteSpace(Model.ProductInfo.CategoryProductPageGuid))
                    {
                        <div class="d-flex rem13px border-top mt-3 text-secondary">
                            <div class="d-flex align-items-center me-3">
                                <i class="bi bi-info-circle"></i>
                            </div>
                            <div class="pt-2" id="category-guide">
                                @Model.ProductInfo.CategoryProductPageGuid
                            </div>
                        </div>
                    }

                    @{
                        var showFreeDeliveryBox = firstProductVariant.Price < 500000 ? "d-none" : "";

                    }
                    <div id="free-delivery-box" class="d-flex border rounded-3 mt-4 justify-content-between p-3 @(showFreeDeliveryBox)">
                        <div class="d-flex flex-column justify-content-between">
                            <span class="fw-bold">ارسال رایگان</span>
                            <span class="rem13px text-secondary">
                                برای سفارش‌ بالای
                                ۵۰۰
                                هزار تومان
                            </span>
                        </div>
                        <img width="100" src="~/images/Application/free-delivery.png" />
                    </div>
                </div>
                <div class="col-md-5">
                    <div class="border rounded-3 p-3" id="product-info-left-side-box">
                        <!-- 1 -->
                        @if ((productVariants.Count(c => c.VariantValue == firstProductVariant.VariantValue) - 1) == 0)
                        {
                            <div class="d-flex justify-content-between align-items-center" id="other-sellers-count-box">
                                <div class="fw-bold">فروشنده</div>
                                <div class="text-info rem13px persian-numbers pointer-cursor" id="other-sellers-count-box">
                                    فروشنده دیگری ندارد
                                </div>
                            </div>


                        }
                        else
                        {
                            <div class="d-flex justify-content-between align-items-center" id="other-sellers-count-box">
                                <div class="fw-bold">فروشنده</div>
                                <div class="text-info rem13px persian-numbers pointer-cursor" id="other-sellers-count-box">
                                    <span class="persian-numbers">@(productVariants.Count(c => c.VariantValue == firstProductVariant.VariantValue) - 1)</span>
                                    فروشنده دیگر
                                </div>
                            </div>
                        }



                        <!-- End 1 -->
                        <!-- 2 -->

                        <div class="d-flex align-items-center mt-3" id="shop-details-in-page-of-product">
                            @{
                                var hassellerlogo = string.IsNullOrWhiteSpace(firstProductVariant.SellerLogo);
                                var sellerLogoUrl = "/images/Application/eshop.png";
                                if (!hassellerlogo)
                                {
                                    sellerLogoUrl = $"/images/seller-logos/{firstProductVariant.SellerLogo}";
                                }
                            }
                            <img class="me-3 @(hassellerlogo ? "d-none": "")" width="50" src="@sellerLogoUrl" alt="@firstProductVariant.SellerShopName" />
                            <i class="bi bi-shop me-2 rem21px @(hassellerlogo ? "": "d-none")"></i>

                            <div>
                                @firstProductVariant.SellerShopName
                            </div>
                        </div>

                        <!-- End 2 -->

                        <hr class="bg-secondary" />

                        <!-- 3 -->

                        <div class="d-flex align-items-center mt-3">
                            <i class="bi bi-shield-check me-2 rem21px"></i>
                            <div class="rem14px " id="garanteeName">
                                <span class="persian-numbers">
                                    @firstProductVariant.GaranteeFullTitle.ToShowGuaranteeFullTitle()
                                </span>
                            </div>
                        </div>

                        <!-- End 3 -->

                        <hr class="bg-secondary" />

                        <!-- 4 -->

                        <div class="d-flex align-items-center mt-3">
                            <i class="bi bi-trophy me-2 rem21px"></i>
                            <div class="rem14px">
                                <span id="scoreProduct" class="persian-numbers">
                                    @firstProductVariant.Score
                                </span>
                                امتیاز پروشاپ
                                <i class="bi bi-info-circle" data-bs-toggle="tooltip" data-bs-placement="bottom"
                                   title="بعد از پایان مهلت مرجوعی، برای دریافت امتیاز به صفحه ماموریت های پروشاپی سر بزنید."></i>
                            </div>
                        </div>

                        <!-- End 4 -->

                        <hr class="bg-secondary" />

                        <!-- 5 -->
                        <div class="d-flex justify-content-between align-items-center mt-3">

                            <div>

                                <i id="product-shopName-tooltip" class="bi bi-info-circle ms-2" data-bs-toggle="tooltip" data-bs-placement="bottom"
                                   title="این کالا توسط فروشنده آن @firstProductVariant.SellerShopName، قیمت گذاری شده است."></i>

                            </div>

                            @foreach (var variants in GroupVariants)
                            {


                                var currentVariant = variants.First();


                                <div variant-value="@currentVariant.VariantValue" class="d-flex flex-column align-items-center product-final-price-in-single-page-of-product  @(firstProductVariant.VariantValue == currentVariant.VariantValue ? (currentVariant.IsDiscountActive?string.Empty:"d-none") :"d-none") ">
                                    <div>
                                        <span class="text-decoration-line-through text-custom-grey rem14px me-2 persian-numbers">
                                            @currentVariant.Price.ToString("0,#")
                                        </span>
                                        <span class="badge rounded-pill bg-danger persian-numbers">@currentVariant.offPercentage%</span>
                                    </div>
                                    <span class="rem21px mt-2 persian-numbers">
                                        @currentVariant.FinalPrice.ToString("0,#")
                                        تومان
                                    </span>
                                </div>
                                <span variant-value="@currentVariant.VariantValue" class="rem21px product-price-in-single-page-of-product @(firstProductVariant.VariantValue == currentVariant.VariantValue ? (currentVariant.IsDiscountActive?"d-none":string.Empty):"d-none")">
                                    <span class="persian-numbers">
                                        @currentVariant.Price.ToString("0,#")
                                    </span>
                                    تومان
                                </span>


                            }

                        </div>

                        <!-- End 5 -->
                        <!-- Low Inventory Stock -->
                        @foreach (var variants in GroupVariants)
                        {
                            var currentVariant = variants.First();
                            if (currentVariant.Count == 0)
                                continue;

                            <div variant-value="@currentVariant.VariantValue"
                                 class="latest-product-stock-in-inventory text-danger mt-3 fw-bold rem13px  @(firstProductVariant.VariantValue == currentVariant.VariantValue ? string.Empty :"d-none")">
                                تنها
                                <span class="persian-numbers">@currentVariant.Count</span>
                                عدد در انبار باقی مانده
                                !
                            </div>
                        }

                        <!-- End Low Inventory Stock -->
                        <!-- 6 -->
                        @foreach (var variants in GroupVariants)
                        {

                            var currentVariant = variants.First();
                            if (currentVariant.IsDiscountActive)
                            {
                                <div variant-value="@currentVariant.VariantValue" class="Product-discount-box d-flex flex-column align-items-center mt-3 text-danger fw-bold   @(firstProductVariant.VariantValue == currentVariant.VariantValue ? string.Empty :"d-none")">
                                    <div>
                                        پیشنهاد شگفت انگیز
                                    </div>
                                    <div class="text-center count-down-timer">
                                        @currentVariant.EndDateTime
                                    </div>
                                </div>
                            }


                        }


                        <!-- End 6 -->
                        <!-- basket -->
                        @foreach (var variants in GroupVariants)
                        {
                            var currentVariant = variants.First();
                            var showbutton = @Model.ProductInfo.ProductVariantInCart.All(c => c.ProductVariantId != currentVariant.Id);
                            <form method="post" call-function-in-the-end="addProductVariantToCart"
                                  asp-page-handler="AddProductVariantToCart" varaint-id="@currentVariant.Id"
                                  class="@(showbutton?string.Empty:"d-none") add-product-variant-to-cart public-ajax-form @(firstProductVariant.VariantValue == currentVariant.VariantValue ? string.Empty :"d-none")">

                                <input type="hidden" name="productVariantId" asp-for="@currentVariant.Id">
                                <div class="d-grid mt-3">
                                    <button class="btn btn-danger rounded-3">
                                        افزودن به سبد خرید
                                    </button>
                                </div>
                            </form>
                        }

                        @foreach (var variants in GroupVariants)
                        {
                            var currentVariant = variants.First();
                            var productVariantInCart = @Model.ProductInfo.ProductVariantInCart.SingleOrDefault(c => c.ProductVariantId == currentVariant.Id);
                            var IsCartFull = false;
                            if (productVariantInCart != null)
                            {
                                IsCartFull = productVariantInCart.Count == currentVariant.MaxCountInCart || productVariantInCart.Count == currentVariant.Count;
                            }

                            var showbutton = productVariantInCart != null;
                            <div class="@(showbutton?string.Empty:"d-none") d-flex mt-3 product-variant-in-cart-section @(firstProductVariant.VariantValue == currentVariant.VariantValue ? string.Empty :"d-none")" variant-id="@currentVariant.Id">
                                <div class="d-flex align-items-center text-danger shadow rounded p-2">


                                    <!-- + -->
                                    <span class="px-2 disable-selecting @(IsCartFull?"text-custom-grey":"pointer-cursor")">
                                        <form method="post" call-function-in-the-end="addProductVariantToCart"
                                              class="public-ajax-form" asp-page-handler="AddProductVariantToCart">
                                            <input type="hidden" name="productVariantId" asp-for="@currentVariant.Id" />
                                            <input type="hidden" name="isIncrease" value="true" />

                                            <span class="rem20px increaseProductVariantInCartButton">+</span>
                                        </form>
                                    </span>
                                    <!-- + -->


                                    <span variant-id="@currentVariant.Id" class="d-flex flex-column justify-content-between px-2 disable-selecting productvariantcountincart">
                                        <span class="fw-bold text-center persian-numbers">
                                            @(productVariantInCart?.Count ?? 0)
                                        </span>
                                        <span class="text-custom-grey rem13px @(IsCartFull?string.Empty : "d-none")">
                                            حداکثر مجاز
                                        </span>
                                    </span>



                                    <span class="px-2 disable-selecting pointer-cursor @((productVariantInCart?.Count==1?string.Empty:"d-none") ?? "d-none")">
                                        <form method="post" call-function-in-the-end="addProductVariantToCart"
                                              class="public-ajax-form" asp-page-handler="AddProductVariantToCart">
                                            <input type="hidden" name="productVariantId" asp-for="@currentVariant.Id" />
                                            <span class="empty-variants-in-cart">

                                                <i class="bi bi-trash"></i>
                                            </span>
                                        </form>
                                    </span>


                                    <!-- - -->
                                    <span class="px-2 disable-selecting  pointer-cursor @((productVariantInCart?.Count>1?string.Empty:"d-none") ?? "d-none")">
                                        <form method="post" call-function-in-the-end="addProductVariantToCart"
                                              class="public-ajax-form" asp-page-handler="AddProductVariantToCart">
                                            <input type="hidden" name="productVariantId" asp-for="@currentVariant.Id" />
                                            <span class="rem20px decreaseProductVariantInCartButton">-</span>
                                        </form>
                                    </span>
                                    <!-- - -->

                                </div>
                                <div class="ms-3 rem13px d-flex justify-content-between flex-column">
                                    <div>در سبد شما</div>
                                    <div>
                                        مشاهده
                                        <a href="#">سبد خرید</a>
                                    </div>
                                </div>
                            </div>
                        }


                        <!-- End basket -->





                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- End show product info -->
<!-- Website features -->

<div class="container mt-3 bg-white py-2 shadow-sm rem14px" id="webstie-features">
    <div class="row">
        <div class="col p-md-3 text-center">
            <a href="#" class="text-secondary">
                <i class="bi bi-box-seam"></i>
                امکان تحویل اکسپرس
            </a>
        </div>
        <div class="col p-md-3 text-center">
            <a href="#" class="text-secondary">
                <i class="bi bi-headset"></i>
                ۲۴ ساعته،
                ۷ روز هفته
            </a>
        </div>
        <div class="col p-md-3 text-center">
            <a href="#" class="text-secondary">
                <i class="bi bi-credit-card-fill rem16px"></i>
                امکان پرداخت در محل
            </a>
        </div>
        <div class="col p-md-3 text-center">
            <a href="#" class="text-secondary">
                <i class="bi bi-box-seam-fill"></i>
                هفت روز ضمانت بازگشت کالا
            </a>
        </div>
        <div class="col p-md-3 text-center">
            <a href="#" class="text-secondary">
                <i class="bi bi-patch-check"></i>
                ضمانت اصل بودن کالا
            </a>
        </div>
    </div>
</div>

<!-- End website features -->

<partial name="_OtherVariantsP" model="(productVariants,Model.ProductInfo.ProductVariantInCart)" />




<div class="container-fluid mt-4 bg-white sticky-top">
    <div class="d-none d-sm-flex justify-content-sm-between justify-content-lg-start rem14px text-secondary border-bottom"
         id="product-options-box-in-single-page-of-product">

        @if (Model.ProductInfo.ShortDescription != null)
        {
            <div id="prodcut-introduction-title-single-page-product" class="mx-3 pointer-cursor p-2 position-relative">
                معرفی
                <div class="bg-danger position-absolute start-0 bottom-0 rounded-top d-none"></div>
            </div>
        }
        @if (Model.ProductInfo.SpecialCheck != null)
        {
            <div id="specialCheck-introduction-title-single-page-product" class="mx-3 pointer-cursor p-2 position-relative">
                بررسی تخصصی
                <div class="bg-danger position-absolute start-0 bottom-0 rounded-top d-none"></div>
            </div>
        }
        @if (Model.ProductInfo.ProductFeatures.Count > 0)
        {
            <div id="productFeatures-introduction-title-single-page-product" class="mx-3 pointer-cursor p-2 position-relative">
                مشخصات
                <div class="bg-danger position-absolute start-0 bottom-0 rounded-top d-none"></div>
            </div>
        }
        <div id="comments-introduction-title-single-page-product" class="mx-3 pointer-cursor p-2 position-relative">
            دیدگاه ها
            <div class="bg-danger position-absolute start-0 bottom-0 rounded-top d-none"></div>
        </div>
        <div id="question-introduction-title-single-page-product" class="mx-3 pointer-cursor p-2 position-relative">
            پرسش ها
            <div class="bg-danger position-absolute start-0 bottom-0 rounded-top d-none"></div>
        </div>

    </div>
</div>

<div class="container-fluid">
    <div class="row">
        <div class="col-lg-12 mt-4" style="text-align:justify">
            @if (Model.ProductInfo.ShortDescription != null)
            {
                <div id="product-introduction-in-single-page-product">
                    <span class="fw-bold rem18px border-bottom border-2 border-danger pe-3 pb-2">معرفی</span>
                </div>
                <div class="row mt-4">
                    <div class="col-lg-12">
                        <div class="mt-4 rem14px" id="product-introduction-in-single-page-of-product">
                            @Html.Raw(Model.ProductInfo.ShortDescription)
                        </div>
                        <div class="mt-2 text-info">
                            <span class="rem14px pointer-cursor">
                                بستن
                                <i class="bi bi-chevron-left rem11px"></i>
                            </span>
                        </div>
                    </div>
                </div>
                <div class="break-line-in-single-page-of-product bg-custom-grey my-4"></div>
            }
            @if (Model.ProductInfo.SpecialCheck != null)
            {

                <div id="specialCheck-introduction-in-single-page-product">
                    <span class="fw-bold rem18px border-bottom border-2 border-danger pe-3 pb-2">بررسی تخصصی</span>
                </div>

                <div class="row mt-4">
                    <div class="col-lg-12">
                        <div class="mt-4" id="product-specialty-check-in-single-page-of-product">
                            @Html.Raw(Model.ProductInfo.SpecialCheck)
                        </div>
                    </div>
                </div>
                <div class="closeandShow">
                    <div class="mt-3 text-info">
                        <span class="rem14px pointer-cursor">
                            <span class="spShow">مشاهده بیشتر</span>
                            <i class="bi bi-chevron-left rem11px"></i>
                        </span>
                    </div>
                </div>
                <div class="break-line-in-single-page-of-product bg-custom-grey my-4"></div>
            }

            @if (Model.ProductInfo.ProductFeatures.Count > 0)
            {
                var counter = 1;

                <div id="productFeatures-introduction-in-single-page-product">
                    <span class="fw-bold rem18px border-bottom border-2 border-danger pe-3 pb-2">مشخصات</span>
                </div>
                <div class="row mt-4">
                    <div class="col-lg-3"></div>
                    <div class="col-lg-6">
                        <div class="mt-4 rem15px" id="product-details-in-single-page-of-product">
                            @foreach (var feature in Model.ProductInfo.ProductFeatures)
                            {
                                <div class="d-flex @(counter++ > 5 ? " d-none" : string.Empty)">
                                    <div class="py-3 text-secondary mx-md-5 me-5">@feature.FeatureTitle</div>
                                    <div class="py-3 flex-grow-1 border-bottom persian-numbers">

                                        @{
                                            var splitValue = feature.Value.Split("|||");
                                            if (splitValue.Length > 1)
                                            {
                                                foreach (var featuresValue in splitValue)
                                                {

                                                    @featuresValue
                                                    @: <br />
                                                }
                                            }
                                            else
                                            {
                                                @feature.Value
                                            }
                                        }
                                    </div>
                                </div>
                            }


                        </div>

                    </div>
                </div>
                @if (Model.ProductInfo.ProductFeatures.Count > 5)
                {
                    <div class="closeandShow">
                        <div class="mt-3 text-info">
                            <span class="rem14px pointer-cursor">
                                <span class="spShow">مشاهده بیشتر</span>
                                <i class="bi bi-chevron-left rem11px"></i>
                            </span>
                        </div>
                    </div>

                }
                @*<div class="mt-2 text-info">
                <span class="rem14px pointer-cursor">
                    بستن
                    <i class="bi bi-chevron-left rem11px"></i>
                </span>
            </div>*@
                <div class="break-line-in-single-page-of-product bg-custom-grey my-4"></div>

            }

            <div id="commnets-introduction-in-single-page-product">
                <span class="fw-bold rem18px border-bottom border-2 border-danger pe-3 pb-2">امتیاز و دیدگاه کاربران</span>
            </div>
            <div class="row mt-4">
                <div class="col-lg-3"></div>
                <div class="col-lg-6">
                    <div class="border-bottom pb-3">
                        <div class="rem13px fw-bold">
                            <i class="bi bi-hand-thumbs-up text-success rem17px"></i>
                            <span class="persian-numbers">۸۷</span>%
                            (<span class="persian-numbers">۲۳۰</span> نفر)
                            درصد از خریداران، این کالا را پیشنهاد کرده اند
                            <i class="bi bi-info-circle rem16px" data-bs-toggle="tooltip" data-bs-placement="bottom"
                               title="خریداران کالا با انتخاب یکی از گزینه های پیشنهاد یا عدم پیشنهاد، تجربه خرید خود را با کاربران به اشتراک می گذارند."></i>
                        </div>
                        <div class="d-flex d-sm-block justify-content-center mt-3">
                            <img src="~/images/Products/24b341bafe674780a584d4b1991a75a8.jpg" class="rounded-3 me-4" width="60" />
                            <img src="~/images/Products/4509892526244f71914a7c718bafce1a.jpg" class="rounded-3 me-4" width="60" />
                        </div>
                        <div class="mt-3 rem13px text-info pointer-cursor">
                            مشاهده همه
                            <i class="bi bi-chevron-left"></i>
                        </div>
                    </div>
                    <div class="d-flex justify-content-between mt-3" id="comments-sorting">
                        <div class="rem13px d-flex">
                            <i class="bi bi-sort-down rem21px me-2"></i>
                            <div class="me-2">مرتب سازی:</div>
                            <div class="text-danger me-2 pointer-cursor" sort-by="Id" order-by="Desc">جدیدترین</div>
                            <div class="text-secondary me-2 pointer-cursor" sort-by="IsBuyer" order-by="Desc">دیدگاه خریداران</div>
                            <div class="text-secondary me-2 pointer-cursor" sort-by="MostUseful">مفیدترین</div>
                        </div>
                        <div class="rem13px text-secondary">
                            <span>@Model.ProductInfo.productCommentsCount</span>
                            دیدگاه
                        </div>
                    </div>
                    <div id="comment-box-in-single-page-of-product">
                        @{
                            var commentModel = new CommentForCommentPartialViewModel()
                            {
                                ProductComments = Model.ProductInfo.productComments,
                                LikedCommentByUser = Model.ProductInfo.LikedCommentByUser,
                                CommentPageCount = Model.ProductInfo.ProductsPageCount,
                                CurrentPage = 1
                            };
                        }
                        <partial name="_CommentPartial" model="commentModel"/>
                    </div>
                </div>
            </div>
            <div class="mt-2 text-info">
                <span class="rem14px pointer-cursor">
                    بستن
                    <i class="bi bi-chevron-left rem11px"></i>
                </span>
            </div>
            <div class="break-line-in-single-page-of-product bg-custom-grey my-4"></div>

            <div id="question-introduction-in-single-page-product">
                <span class="fw-bold rem18px border-bottom border-2 border-danger pe-3 pb-2">پرسش و پاسخ</span>
            </div>

            <div class="row mt-4">
                <div class="col-lg-3"></div>
                <div class="col-lg-6">
                    <div class="d-flex justify-content-between mt-3">
                        <div class="rem13px d-flex">
                            <i class="bi bi-sort-down rem21px me-2"></i>
                            <div class="me-2">مرتب سازی:</div>
                            <div class="text-danger me-2 pointer-cursor">جدیدترین</div>
                            <div class="text-secondary me-2 pointer-cursor">مفیدترین</div>
                        </div>
                        <div class="rem13px text-secondary">
                            <span class="persian-numbers">@Model.ProductInfo.productQuestionsCount</span>
                            پرسش
                        </div>
                    </div>
                    <div class="mt-4">
                        @foreach (var question in Model.ProductInfo.ProductsQuestionsAndAnswers)
                        {
                            <div class="border-bottom pb-3 question-box-in-single-page-product">
                                <div class="d-flex align-items-center">
                                    <div>
                                        <i class="bi bi-question-square rem21px text-info"></i>
                                    </div>
                                    <div class="ms-3">
                                        @question.Body
                                    </div>
                                </div>
                                @foreach (var answer in question.Answers.Select((value, index) => new { index, value }))
                                {
                                    <div class="d-flex mt-3 text-secondary@(answer.index>0?"d-none":"")">
                                        <div class="rem13px">
                                            پاسخ
                                        </div>
                                        <div class="ms-3 rem14px flex-grow-1">
                                            <div>
                                                @answer.value.Body
                                            </div>
                                            <div class="mt-4 d-flex justify-content-between align-items-center border-bottom pb-2">
                                                <div class="d-flex rem13px">
                                                    <div>@(string.IsNullOrWhiteSpace(answer.value.Name) ? "کاربر سایت" : answer.value.Name)</div>
                                                    @if (answer.value.IsBuyer)
                                                    {
                                                        <div class="ms-2 px-2 buyer-backgournd-color-in-single-page-of-product text-dark">خریدار</div>
                                                    }
                                                    else if (answer.value.IsShop)
                                                    {
                                                        <div class="ms-2 px-2 buyer-backgournd-color-in-single-page-of-product text-dark">فروشگاه</div>
                                                    }
                                                </div>
                                                <div class="d-flex text-black-50 rem14px align-items-center">
                                                    <div class="me-3 me-md-5">آیا این پاسخ مفید بود ؟</div>
                                                    <div class="me-3 pointer-cursor">
                                                        <span class="persian-numbers">@answer.value.Like</span>
                                                        <i class="bi bi-hand-thumbs-up rem19px"></i>
                                                    </div>
                                                    <div class="pointer-cursor">
                                                        <span class="persian-numbers">@answer.value.Dislike</span>
                                                        <i class="bi bi-hand-thumbs-down rem19px"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            @if (question.Answers.Count > 1 && answer.index == 0)
                                            {
                                                <div class="d-flex mt-3">
                                                    <div class="text-info rem14px pointer-cursor show-another-answer=button">
                                                        مشاهده پاسخ های دیگر
                                                        <i class="bi bi-chevron-down"></i>
                                                    </div>
                                                </div>
                                            }
                                        </div>
                                    </div>
                                }
                                <div class="text-info rem14px mt-3 pointer-cursor @(question.Answers.Count>1?"d-none":"")">
                                    ثبت پاسخ
                                    @if (question.Answers.Count > 0)
                                    {
                                        @: جدید
                                    }
                                    <i class="bi bi-chevron-left"></i>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>

        <div class="break-line-in-single-page-of-product bg-custom-grey my-4"></div>
        </div>
        <div class="col-lg-3 d-none d-lg-block"></div>
    </div>
</div>





@{

    var shareProductModel = (Model.ProductInfo.PersianTitle, Url.PageLink("/Product/ProductShortLink", null, new { productshortLink = @Model.ProductInfo.ProductShortLinkLink }));

}
<partial name="_ShareProductP" model=shareProductModel />



@section CustomScripts{

    <script src="~/Pages/Product/Index.cshtml.js"></script>

}

@section Scripts{

    <script src="~/lib/js-image-zoom/js-image-zoom.min.js"></script>
}